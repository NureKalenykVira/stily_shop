<div class="contact-form">
  <h1 class="page-title">Змінити пароль</h1>

  <p class="note">
    Твій новий пароль не може бути таким самим, як попередній.
  </p>

  <form #passwordForm="ngForm" (ngSubmit)="save(passwordForm)">
    <label>
      Поточний пароль *
      <div class="password-wrapper">
        <input
          [type]="showCurrentPassword ? 'text' : 'password'"
          name="currentPassword"
          [(ngModel)]="currentPassword"
          required
          #currentPasswordField="ngModel"
        />
        <button
          type="button"
          class="toggle-password"
          (click)="togglePasswordVisibility('current')"
          aria-label="Toggle password visibility"
        >
          <img
            [src]="showCurrentPassword ? 'assets/icons/hide.svg' : 'assets/icons/show.svg'"
            alt="toggle"
          />
        </button>
      </div>
      <small class="error" *ngIf="currentPasswordField.invalid && (currentPasswordField.touched || passwordForm.submitted)">
        Введіть поточний пароль.
      </small>
    </label>

    <label>
      Новий пароль *
      <small class="hint">
        ⓘ Пароль має містити щонайменше 8 символів, включаючи малу літеру, велику літеру та цифру.
      </small>
      <div class="password-wrapper">
        <input
          [type]="showNewPassword ? 'text' : 'password'"
          name="newPassword"
          [(ngModel)]="newPassword"
          required
          pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$"
          #newPasswordField="ngModel"
        />
        <button
          type="button"
          class="toggle-password"
          (click)="togglePasswordVisibility('new')"
          aria-label="Toggle password visibility"
        >
          <img
            [src]="showNewPassword ? 'assets/icons/hide.svg' : 'assets/icons/show.svg'"
            alt="toggle"
          />
        </button>
      </div>
      <small class="error" *ngIf="(newPasswordField.touched || passwordForm.submitted)">
        <ng-container *ngIf="newPasswordField.errors?.['required']">
          Введіть новий пароль.
        </ng-container>
        <ng-container *ngIf="newPasswordField.errors?.['pattern']">
          Пароль не відповідає вимогам.
        </ng-container>
        <ng-container *ngIf="!newPasswordField.errors && currentPassword === newPassword">
          Новий пароль не може бути таким самим, як попередній.
        </ng-container>
      </small>
    </label>

    <label>
      Підтвердь пароль *
      <div class="password-wrapper">
        <input
          [type]="showConfirmPassword ? 'text' : 'password'"
          name="confirmPassword"
          [(ngModel)]="confirmPassword"
          required
          #confirmPasswordField="ngModel"
        />
        <button
          type="button"
          class="toggle-password"
          (click)="togglePasswordVisibility('confirm')"
          aria-label="Toggle password visibility"
        >
          <img
            [src]="showConfirmPassword ? 'assets/icons/hide.svg' : 'assets/icons/show.svg'"
            alt="toggle"
          />
        </button>
      </div>
      <small class="error" *ngIf="(confirmPasswordField.touched || passwordForm.submitted) && confirmPassword !== newPassword">
        Паролі не збігаються.
      </small>
    </label>

    <div class="form-actions">
      <button type="submit" class="submit-button" [disabled]="passwordForm.invalid || confirmPassword !== newPassword">
        Зберегти
      </button>
    </div>
  </form>
</div>
